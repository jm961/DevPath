---
import type { RoadmapFileType } from '../lib/roadmap';

export interface Props {
  url: string;
  title: string;
  description: string;
  isNew: boolean;
  difficulty?: 'beginner' | 'intermediate' | 'advanced';
  timeEstimate?: string;
  isRecommended?: boolean;
}

const { url, title, description, isNew, difficulty, timeEstimate, isRecommended } = Astro.props;

const difficultyConfig = {
  beginner: { color: 'text-green-400', bg: 'bg-green-500/10', ring: 'ring-green-500/20', label: 'Beginner' },
  intermediate: { color: 'text-yellow-400', bg: 'bg-yellow-500/10', ring: 'ring-yellow-500/20', label: 'Intermediate' },
  advanced: { color: 'text-red-400', bg: 'bg-red-500/10', ring: 'ring-red-500/20', label: 'Advanced' },
};

const difficultyStyle = difficulty ? difficultyConfig[difficulty] : null;
---

<a
  href={url}
  class='roadmap-card group relative flex h-full flex-col justify-between overflow-hidden rounded-3xl p-5 no-underline sm:p-6'
>
  <!-- Animated gradient border -->
  <div class='roadmap-card-border'></div>
  
  <!-- Background with glass effect -->
  <div class='roadmap-card-bg'></div>
  
  <!-- Glow halo effect -->
  <div class='roadmap-card-glow'></div>
  
  <!-- Shine sweep effect -->
  <div class='roadmap-card-shine'></div>

  <!-- Content -->
  <div class='relative z-10'>
    <div class='mb-3 flex items-center gap-2'>
      {difficultyStyle && (
        <span class={`inline-flex items-center gap-1.5 rounded-full ${difficultyStyle.bg} ${difficultyStyle.ring} px-2.5 py-0.5 text-xs font-semibold ${difficultyStyle.color} ring-1`}>
          <div class={`h-1.5 w-1.5 rounded-full ${difficultyStyle.color.replace('text-', 'bg-')}`}></div>
          {difficultyStyle.label}
        </span>
      )}
      {timeEstimate && (
        <span class='inline-flex items-center gap-1.5 rounded-full bg-white/5 px-2.5 py-0.5 text-xs font-medium text-muted ring-1 ring-white/10'>
          <svg class='h-3 w-3' fill='none' stroke='currentColor' viewBox='0 0 24 24'>
            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z'></path>
          </svg>
          {timeEstimate}
        </span>
      )}
    </div>
    <h3
      class='mb-2 text-lg font-bold text-white transition-all duration-300 group-hover:translate-x-1 sm:text-xl'
    >
      {title}
    </h3>
    <p class='hidden text-sm leading-relaxed text-muted transition-all duration-300 group-hover:text-white/80 sm:block'>
      {description}
    </p>
  </div>

  <div class='relative z-10 mt-4 flex items-center gap-2'>
    <span
      class='text-sm font-medium text-muted transition-all duration-300 group-hover:text-primary-light'
    >
      {difficulty === 'beginner' ? 'Start Learning' : 'Explore Path'}
    </span>
    <svg
      class='h-4 w-4 text-muted transition-all duration-300 group-hover:translate-x-2 group-hover:text-primary-light'
      fill='none'
      stroke='currentColor'
      viewBox='0 0 24 24'
    >
      <path
        stroke-linecap='round'
        stroke-linejoin='round'
        stroke-width='2'
        d='M13 7l5 5m0 0l-5 5m5-5H6'></path>
    </svg>
  </div>

  <div class='absolute right-4 top-4 z-20 flex flex-col items-end gap-2'>
    {isRecommended && (
      <span class='flex items-center gap-1.5 rounded-full bg-gradient-to-r from-accent/20 to-yellow-500/20 px-2.5 py-1 text-xs font-semibold text-accent ring-1 ring-accent/30 backdrop-blur-sm transition-all duration-300 group-hover:ring-accent/50 group-hover:shadow-lg group-hover:shadow-accent/20'>
        <svg class='h-3 w-3 fill-current' viewBox='0 0 20 20'>
          <path d='M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z'></path>
        </svg>
        Best for Beginners
      </span>
    )}
    {isNew && (
      <span class='flex items-center gap-1.5 rounded-full bg-gradient-to-r from-accent/20 to-accent/10 px-2.5 py-1 text-xs font-semibold text-accent ring-1 ring-accent/30 backdrop-blur-sm transition-all duration-300 group-hover:ring-accent/50 group-hover:shadow-lg group-hover:shadow-accent/20'>
        <span class='flex h-1.5 w-1.5'>
          <span class='absolute inline-flex h-1.5 w-1.5 animate-ping rounded-full bg-accent opacity-75' />
          <span class='relative inline-flex h-1.5 w-1.5 rounded-full bg-accent' />
        </span>
        New
      </span>
    )}
  </div>
</a>

<style>
  .roadmap-card {
    position: relative;
    background: transparent;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    transform-style: preserve-3d;
  }

  /* Animated gradient border */
  .roadmap-card-border {
    position: absolute;
    inset: 0;
    border-radius: 1.5rem;
    padding: 1px;
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.1),
      rgba(59, 130, 246, 0.2),
      rgba(168, 85, 247, 0.2),
      rgba(255, 255, 255, 0.1)
    );
    background-size: 200% 200%;
    -webkit-mask: 
      linear-gradient(#fff 0 0) content-box, 
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    opacity: 0.6;
  }

  .roadmap-card:hover .roadmap-card-border {
    background: linear-gradient(
      135deg,
      rgba(59, 130, 246, 0.5),
      rgba(168, 85, 247, 0.5),
      rgba(6, 182, 212, 0.5),
      rgba(59, 130, 246, 0.5)
    );
    background-size: 200% 200%;
    animation: gradient-rotate 3s ease infinite;
    opacity: 1;
  }

  @keyframes gradient-rotate {
    0%, 100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  /* Glass background */
  .roadmap-card-bg {
    position: absolute;
    inset: 0;
    border-radius: 1.5rem;
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.02) 100%
    );
    backdrop-filter: blur(20px) saturate(180%);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 
      0 2px 8px rgba(0, 0, 0, 0.4),
      0 16px 48px rgba(0, 0, 0, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
  }

  .roadmap-card:hover .roadmap-card-bg {
    background: linear-gradient(
      135deg,
      rgba(59, 130, 246, 0.08) 0%,
      rgba(168, 85, 247, 0.05) 50%,
      rgba(6, 182, 212, 0.08) 100%
    );
    box-shadow: 
      0 8px 16px rgba(0, 0, 0, 0.4),
      0 24px 64px rgba(59, 130, 246, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }

  /* Glow halo */
  .roadmap-card-glow {
    position: absolute;
    inset: -2px;
    border-radius: 1.5rem;
    background: radial-gradient(
      600px circle at var(--mouse-x, 50%) var(--mouse-y, 50%),
      rgba(59, 130, 246, 0.15),
      transparent 40%
    );
    opacity: 0;
    transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: -1;
    filter: blur(20px);
  }

  .roadmap-card:hover .roadmap-card-glow {
    opacity: 1;
  }

  /* Shine sweep */
  .roadmap-card-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.08),
      transparent
    );
    transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1;
    pointer-events: none;
  }

  .roadmap-card:hover .roadmap-card-shine {
    left: 100%;
  }

  /* Hover lift effect */
  .roadmap-card:hover {
    transform: translateY(-8px) translateZ(20px);
  }

  /* Active/pressed state */
  .roadmap-card:active {
    transform: translateY(-4px) translateZ(10px) scale(0.98);
  }
</style>
