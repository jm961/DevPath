---
import Icon from '../AstroIcon.astro';
const { pageUrl, name } = Astro.props;

export interface Props {
  pageUrl: string;
  name: string;
}
---

<div
  class='container flex min-h-[calc(100vh-37px-70px)] items-stretch sm:min-h-[calc(100vh-37px-96px)]'
>
  <aside class='hidden w-56 border-r border-white/10 py-10 pr-5 md:block'>
    <nav>
      <ul class='space-y-1'>
        <li>
          <a
            href='/settings/update-profile'
            class=`block w-full rounded-lg px-3 py-2 text-sm font-medium transition-all ${pageUrl === 'profile' ? 'bg-white/10 text-white' : 'text-[#8b949e] hover:bg-white/5 hover:text-white'}`
            >Profile</a
          >
        </li>
        <li>
          <a
            href='/settings/update-password'
            class=`block w-full rounded-lg px-3 py-2 text-sm font-medium transition-all ${pageUrl === 'change-password' ? 'bg-white/10 text-white' : 'text-[#8b949e] hover:bg-white/5 hover:text-white'}`
            >Security</a
          >
        </li>
      </ul>
    </nav>
  </aside>
  <div class='grow py-10 pl-0 md:p-10 md:pr-0'>
    <div class='relative mb-5 md:hidden'>
      <button
        class='flex h-10 w-full items-center justify-between rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm font-medium text-white backdrop-blur-xl transition-all hover:bg-white/8'
        id='settings-menu'
      >
        {name}
        <Icon icon='dropdown' />
      </button>
      <ul
        id='settings-menu-dropdown'
        class='absolute mt-1 hidden w-full space-y-1 rounded-xl border border-white/10 bg-[#0d1117]/95 p-2 shadow-2xl backdrop-blur-xl'
      >
        <li>
          <a
            href='/settings/update-profile'
            class=`block w-full rounded-lg px-3 py-2 text-sm font-medium transition-all ${pageUrl === 'profile' ? 'bg-white/10 text-white' : 'text-[#8b949e] hover:bg-white/5 hover:text-white'}`
            >Profile</a
          >
        </li>
        <li>
          <a
            href='/settings/update-password'
            class=`block w-full rounded-lg px-3 py-2 text-sm font-medium transition-all ${pageUrl === 'change-password' ? 'bg-white/10 text-white' : 'text-[#8b949e] hover:bg-white/5 hover:text-white'}`
            >Security</a
          >
        </li>
      </ul>
    </div>

    <slot />
  </div>
</div>

<script>
  const menuButton = document.getElementById('settings-menu');
  const menuDropdown = document.getElementById('settings-menu-dropdown');

  menuButton?.addEventListener('click', () => {
    menuDropdown?.classList.toggle('hidden');
  });

  document.addEventListener('click', (e) => {
    if (!menuButton?.contains(e.target as Node)) {
      menuDropdown?.classList.add('hidden');
    }
  });
</script>
