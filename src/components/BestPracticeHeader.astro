---
import BestPracticeHint from './BestPracticeHint.astro';
import DownloadPopup from './DownloadPopup.astro';
import Icon from './AstroIcon.astro';
import LoginPopup from './AuthenticationFlow/LoginPopup.astro';
import SubscribePopup from './SubscribePopup.astro';

export interface Props {
  title: string;
  description: string;
  bestPracticeId: string;
  isUpcoming?: boolean;
}

const { title, description, bestPracticeId, isUpcoming = false } = Astro.props;
const isBestPracticeReady = !isUpcoming;
---

<LoginPopup />

<div class='relative border-b border-white/5 bg-gradient-to-b from-surface/50 to-transparent'>
  <div class='container relative py-8 sm:py-16'>
    <!-- Breadcrumb navigation -->
    <nav class='mb-6 flex items-center gap-2 text-sm' aria-label='Breadcrumb'>
      <a href='/best-practices' class='text-muted transition-colors hover:text-primary'>
        All Best Practices
      </a>
      <svg class='h-4 w-4 text-muted' fill='none' stroke='currentColor' viewBox='0 0 24 24'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 5l7 7-7 7'></path>
      </svg>
      <span class='font-medium text-white'>{title}</span>
    </nav>

    <!-- Title and description -->
    <div class='mb-6 sm:mb-8'>
      <div class='mb-4 flex flex-wrap items-center gap-2'>
        <span class='inline-flex items-center gap-1.5 rounded-full bg-accent/10 px-2.5 py-0.5 text-xs font-semibold text-accent ring-1 ring-accent/20'>
          <svg class='h-3 w-3' fill='currentColor' viewBox='0 0 20 20'>
            <path d='M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z'></path>
          </svg>
          Best Practice
        </span>
      </div>
      
      <h1 class='mb-3 text-3xl font-black leading-tight text-white sm:text-5xl lg:text-6xl'>
        {title}
      </h1>
      <p class='max-w-3xl text-base text-muted sm:text-lg'>{description}</p>
    </div>

    <!-- Actions -->
    <div class='flex flex-wrap items-center gap-2 sm:gap-3'>
      <button
        data-guest-required
        data-popup='login-popup'
        class='btn-ghost hidden items-center justify-center gap-2 rounded-xl px-4 py-2.5 text-sm font-medium'
        aria-label='Subscribe for Updates'
        ga-category='Subscription'
        ga-action='Clicked Popup Opener'
        ga-label='Subscribe Best Practice Popup'
      >
        <Icon icon='email' class='h-4 w-4' />
        <span>Subscribe</span>
      </button>

      {isBestPracticeReady && (
        <a
          href={`/feedback?url=${encodeURIComponent(`/best-practices/${bestPracticeId}`)}&type=suggestion`}
          class='btn-ghost inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2.5 text-sm font-medium'
          aria-label='Suggest Changes'
        >
          <Icon icon='comment' class='h-4 w-4' />
          <span class='hidden sm:inline'>Suggest Changes</span>
          <span class='inline sm:hidden'>Suggest</span>
        </a>
      )}
    </div>

    <BestPracticeHint bestPracticeId={bestPracticeId} />
  </div>
</div>
