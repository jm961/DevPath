---
import GuideListItem from '../../components/GuideListItem.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getAllGuides } from '../../lib/guide';

const guides = await getAllGuides();

// Get recent guides (last 6 months)
const sixMonthsAgo = new Date();
sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 6);
const recentGuides = guides.filter(guide => 
  new Date(guide.frontmatter.date) >= sixMonthsAgo
);
const olderGuides = guides.filter(guide => 
  new Date(guide.frontmatter.date) < sixMonthsAgo
);
---

<BaseLayout
  title='Guides - DevPath'
  description={'Detailed guides on Software Engineering Topics'}
  permalink={`/guides`}
>
  <!-- Landing-like background and hero to match homepage -->
  <div class='relative'>
    <div class='animated-landing-bg'>
      <div class='gradient-orb gradient-orb-1'></div>
      <div class='gradient-orb gradient-orb-2'></div>
      <div class='gradient-orb gradient-orb-3'></div>
      <div class='gradient-orb gradient-orb-4'></div>
      <div class='gradient-orb gradient-orb-5'></div>
    </div>

    <!-- Hero Section -->
    <div class='relative'>
      <div class='container px-6 py-14 sm:py-24 lg:py-28'>
        <div class='mx-auto max-w-5xl text-center'>
          <h1 class='mb-6 text-5xl font-black leading-[1.1] tracking-tight text-white sm:text-7xl'>
            Developer Guides
          </h1>
          <p class='mx-auto max-w-2xl text-lg text-muted sm:text-xl'>
            Concise, visual explanations of complex engineering concepts. Learn faster with practical examples.
          </p>
        </div>
      </div>
    </div>

    <!-- Quick Info Guide -->
    <div class='pb-12 pt-4'>
      <div class='container'>
        <div class='mx-auto max-w-4xl rounded-3xl border border-primary/20 bg-gradient-to-br from-primary/10 via-transparent to-accent/5 p-8 backdrop-blur-sm'>
          <div class='mb-4 flex items-center gap-3'>
            <div class='flex h-10 w-10 items-center justify-center rounded-full bg-primary/20'>
              <svg class='h-5 w-5 text-primary' fill='none' stroke='currentColor' viewBox='0 0 24 24'>
                <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253'></path>
              </svg>
            </div>
            <h2 class='text-2xl font-bold text-white'>Learn by Doing</h2>
          </div>
          <p class='mb-6 text-muted'>
            Each guide breaks down a complex topic into digestible chunks with code examples, 
            diagrams, and practical use cases you can apply immediately.
          </p>
        </div>
      </div>
    </div>

    <!-- Recent Guides -->
    {recentGuides.length > 0 && (
      <div class='pb-16 pt-4'>
        <div class='container'>
          <div class='mb-8'>
            <div class='mb-3 inline-flex items-center gap-2 rounded-full bg-accent/10 px-4 py-2 ring-1 ring-accent/20'>
              <svg class='h-4 w-4 text-accent' fill='none' stroke='currentColor' viewBox='0 0 24 24'>
                <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 10V3L4 14h7v7l9-11h-7z'></path>
              </svg>
              <span class='text-sm font-semibold text-accent'>Recently Added</span>
            </div>
            <h2 class='text-3xl font-black text-white sm:text-4xl'>Latest Guides</h2>
            <p class='mt-2 text-muted'>Fresh content to keep you up to date with modern development practices</p>
          </div>
          <div class='space-y-3 sm:space-y-4'>
            {recentGuides.map((guide) => <GuideListItem guide={guide} />)}
          </div>
        </div>
      </div>
    )}

    <!-- All Guides / Older Guides -->
    <div class='pb-20 pt-4 sm:pb-28'>
      <div class='container'>
        {recentGuides.length > 0 && olderGuides.length > 0 && (
          <div class='mb-8'>
            <h2 class='text-3xl font-black text-white sm:text-4xl'>All Guides</h2>
            <p class='mt-2 text-muted'>Comprehensive collection of engineering concepts and techniques</p>
          </div>
        )}
        <div class='space-y-3 sm:space-y-4'>
          {(recentGuides.length > 0 ? olderGuides : guides).map((guide) => <GuideListItem guide={guide} />)}
        </div>
      </div>
    </div>
  </div>
</BaseLayout>
