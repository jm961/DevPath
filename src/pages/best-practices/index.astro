---
import GridItem from '../../components/GridItem.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getAllBestPractices } from '../../lib/best-pratice';

const bestPractices = await getAllBestPractices();

// Define categories and metadata for best practices
const bestPracticeMeta: Record<string, { category: 'frontend' | 'backend' | 'cloud', featured?: boolean }> = {
  'frontend-performance': { category: 'frontend', featured: true },
  'api-security': { category: 'backend', featured: true },
  'aws': { category: 'cloud', featured: false },
};

// Get featured best practices
const featuredBestPractices = bestPractices.filter(bp => bestPracticeMeta[bp.id]?.featured);
const otherBestPractices = bestPractices.filter(bp => !bestPracticeMeta[bp.id]?.featured);
---

<BaseLayout
  title='Best Practices'
  description={'Best practices on different topics with detailed implementation guidelines'}
  permalink={'/best-practices'}
>
  <!-- Landing-like background and hero to match homepage -->
  <div class='relative'>
    <div class='animated-landing-bg'>
      <div class='gradient-orb gradient-orb-1'></div>
      <div class='gradient-orb gradient-orb-2'></div>
      <div class='gradient-orb gradient-orb-3'></div>
      <div class='gradient-orb gradient-orb-4'></div>
      <div class='gradient-orb gradient-orb-5'></div>
    </div>

    <!-- Hero Section -->
    <div class='relative'>
      <div class='container px-6 py-14 sm:py-24 lg:py-28'>
        <div class='mx-auto max-w-5xl text-center'>
          <h1 class='mb-6 text-5xl font-black leading-[1.1] tracking-tight text-white sm:text-7xl'>
            Best Practices
          </h1>
          <p class='mx-auto max-w-2xl text-lg text-muted sm:text-xl'>
            Industry-proven guidelines and checklists to build secure, performant, and scalable applications.
          </p>
        </div>
      </div>
    </div>

    <!-- Quick Info Guide -->
    <div class='pb-12 pt-4'>
      <div class='container'>
        <div class='mx-auto max-w-4xl rounded-3xl border border-primary/20 bg-gradient-to-br from-primary/10 via-transparent to-accent/5 p-8 backdrop-blur-sm'>
          <div class='mb-4 flex items-center gap-3'>
            <div class='flex h-10 w-10 items-center justify-center rounded-full bg-primary/20'>
              <svg class='h-5 w-5 text-primary' fill='none' stroke='currentColor' viewBox='0 0 24 24'>
                <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z'></path>
              </svg>
            </div>
            <h2 class='text-2xl font-bold text-white'>Production-Ready Standards</h2>
          </div>
          <p class='mb-6 text-muted'>
            Each best practice guide includes detailed implementation steps, common pitfalls to avoid, 
            and practical examples from real-world applications.
          </p>
        </div>
      </div>
    </div>

    <!-- Featured Best Practices -->
    {featuredBestPractices.length > 0 && (
      <div class='pb-16 pt-4'>
        <div class='container'>
          <div class='mb-8 text-center'>
            <div class='mb-3 inline-flex items-center gap-2 rounded-full bg-accent/10 px-4 py-2 ring-1 ring-accent/20'>
              <svg class='h-4 w-4 text-accent' fill='currentColor' viewBox='0 0 20 20'>
                <path d='M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z'></path>
              </svg>
              <span class='text-sm font-semibold text-accent'>Featured Guides</span>
            </div>
            <h2 class='text-3xl font-black text-white sm:text-4xl'>Essential for Every Developer</h2>
            <p class='mx-auto mt-2 max-w-2xl text-muted'>Start with these critical best practices to improve your application's quality</p>
          </div>
          <div class='grid grid-cols-1 gap-4 sm:grid-cols-2 lg:gap-5'>
            {featuredBestPractices.map((bestPractice) => (
              <GridItem
                url={`/best-practices/${bestPractice.id}`}
                isNew={bestPractice.frontmatter.isNew}
                title={bestPractice.frontmatter.briefTitle}
                description={bestPractice.frontmatter.description}
                isRecommended={true}
              />
            ))}
          </div>
        </div>
      </div>
    )}

    <!-- All Best Practices -->
    <div class='pb-20 pt-4 sm:pb-28'>
      <div class='container'>
        {featuredBestPractices.length > 0 && (
          <div class='mb-8'>
            <h2 class='text-3xl font-black text-white sm:text-4xl'>More Best Practices</h2>
            <p class='mt-2 text-muted'>Additional guides covering specialized topics and technologies</p>
          </div>
        )}
        <div class='grid grid-cols-1 gap-4 sm:grid-cols-2 lg:gap-5'>
          {(featuredBestPractices.length > 0 ? otherBestPractices : bestPractices).map((bestPractice) => (
            <GridItem
              url={`/best-practices/${bestPractice.id}`}
              isNew={bestPractice.frontmatter.isNew}
              title={bestPractice.frontmatter.briefTitle}
              description={bestPractice.frontmatter.description}
            />
          ))}
        </div>
      </div>
    </div>
  </div>
</BaseLayout>
