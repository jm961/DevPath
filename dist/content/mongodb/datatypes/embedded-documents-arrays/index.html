<!DOCTYPE html><link href=/_astro/_...topicId_.bad8bb91.css rel=stylesheet /><main class=prose-custom id=main-content><h1 id=embedded-documents-and-arrays>Embedded Documents and Arrays</h1><p>In MongoDB, one of the powerful features is the ability to store complex data structures like Embedded Documents Arrays. These are essentially arrays of sub-documents (also known as nested documents) that can be stored within a single document. This allows us to model complex data relationships in a highly efficient way while maintaining good performance.</p><h2 id=what-are-embedded-documents-arrays>What are Embedded Documents Arrays?</h2><p>Embedded Documents Arrays are used when you need to represent a ‘one-to-many’ or hierarchical relationship between data. Instead of using separate collections and references, you can embed the related documents directly into the main document using an array.</p><p>Here’s an example of a document containing an embedded array of sub-documents:</p><pre class="astro-code dracula" is:raw="" style=background-color:#282a36;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f8f8f2>{</span></span>
<span class=line><span style=color:#f8f8f2>    _id: </span><span style=color:#bd93f9>1</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>    name: </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>John Doe</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>    addresses: [</span></span>
<span class=line><span style=color:#f8f8f2>        {</span></span>
<span class=line><span style=color:#f8f8f2>            street</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>123 Main St</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>            city</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>New York</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>            zipcode</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>10001</span><span style=color:#e9f284>'</span></span>
<span class=line><span style=color:#f8f8f2>        },</span></span>
<span class=line><span style=color:#f8f8f2>        {</span></span>
<span class=line><span style=color:#f8f8f2>            street</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>456 Broadway</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>            city</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>Los Angeles</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>            zipcode</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>90001</span><span style=color:#e9f284>'</span></span>
<span class=line><span style=color:#f8f8f2>        }</span></span>
<span class=line><span style=color:#f8f8f2>    ]</span></span>
<span class=line><span style=color:#f8f8f2>}</span></span></code></pre><p>In this example, the <code>addresses</code> field represents an array of embedded sub-documents that contain the address details for the user.</p><h2 id=advantages>Advantages</h2><p>Embedded Documents Arrays offer a few key advantages:</p><ul><li><strong>Read/Write Performance</strong>: Since related data is stored together within the same document, read and write operations can be faster, as they don’t require multiple queries or updates.</li><li><strong>Data Consistency</strong>: By storing related data together, you can easily maintain consistency and ensure that related data is always in-sync without having to rely on joins or cross-references.</li><li><strong>Scalability</strong>: Embedded arrays can be nested, allowing you to represent complex data structures while maintaining the benefits of a flexible schema and high performance.</li></ul><h2 id=when-to-use-embedded-documents-arrays>When to Use Embedded Documents Arrays</h2><p>Consider using Embedded Documents Arrays when:</p><ul><li>You have a one-to-many relationship</li><li>The embedded data does not grow unbounded</li><li>The embedded data is strongly related to the parent document</li><li>You can benefit from improved read/write performance</li></ul><p>Keep in mind that MongoDB has a document size limitation of 16MB, so if you expect the embedded data to grow over time, you should consider alternative approaches, such as using separate collections and referencing them instead.</p><h2 id=querying-embedded-documents-arrays>Querying Embedded Documents Arrays</h2><p>Querying documents with embedded arrays is easy thanks to MongoDB’s built-in array query operators, such as <code>$elemMatch</code>, <code>$all</code>, and <code>$size</code>. You can also use dot notation to search and update embedded sub-documents.</p><p>For example, to find all users with a specific street address, you would use the following query:</p><pre class="astro-code dracula" is:raw="" style=background-color:#282a36;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f8f8f2>db.users.</span><span style=color:#50fa7b>find</span><span style=color:#f8f8f2>({ </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>addresses.street</span><span style=color:#e9f284>'</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>123 Main St</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2> });</span></span></code></pre><p>Overall, Embedded Documents Arrays are a powerful feature in MongoDB, allowing you to store complex data relationships in a performant and efficient manner. Use them wisely to take full advantage of MongoDB’s flexibility and scalability.</p></main>