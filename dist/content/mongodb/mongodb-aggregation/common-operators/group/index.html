<!DOCTYPE html><link href=/_astro/_...topicId_.bad8bb91.css rel=stylesheet /><main class=prose-custom id=main-content><h1 id=group>$group</h1><p>The <code>$group</code> operator in MongoDB is used to aggregate and perform operations on the grouped data. The operator allows you to categorize documents in a collection based on specific fields and perform various operations on each group. These operations range from counting the number of documents in a group, to summing up the values of a particular field, to calculating average values, and many more.</p><h4 id=basic-usage>Basic Usage</h4><p>The basic syntax for the <code>$group</code> operator is as follows:</p><pre class="astro-code dracula" is:raw="" style=background-color:#282a36;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f8f8f2>{</span></span>
<span class=line><span style=color:#f8f8f2>  $group: {</span></span>
<span class=line><span style=color:#f8f8f2>    _id: &#x3C;</span><span style=color:#ff79c6>expression</span><span style=color:#f8f8f2>>,</span></span>
<span class=line><span style=color:#f8f8f2>    &#x3C;</span><span style=color:#ff79c6>field1</span><span style=color:#f8f8f2>>: </span><span style=color:#ff79c6>{</span><span style=color:#f8f8f2> &#x3C;</span><span style=color:#ff79c6>accumulator1</span><span style=color:#f8f8f2>> : &#x3C;</span><span style=color:#ff79c6>expression1</span><span style=color:#f8f8f2>> },</span></span>
<span class=line><span style=color:#f8f8f2>    ...</span></span>
<span class=line><span style=color:#f8f8f2>  }</span></span>
<span class=line><span style=color:#f8f8f2>}</span></span></code></pre><p>Here’s a quick breakdown of the components:</p><ul><li><code>_id</code>: This field represents the criteria for grouping the documents. It can be a single field name or an expression that returns a value.</li><li><code>&#x3C;field1></code>: This is the name of the field you want to create in the resulting documents, which store the computed values from the group.</li><li><code>&#x3C;accumulator1></code>: This is one of the <a href=https://docs.mongodb.com/manual/reference/operator/aggregation/#grp._S_grp rel="noopener noreferrer nofollow" target=_blank>accumulators</a> that MongoDB provides (e.g. <code>$sum</code>, <code>$avg</code>, <code>$min</code>, <code>$max</code>, <code>$push</code>, etc.). They specify the operation to perform on the grouped data.</li><li><code>&#x3C;expression1></code>: This is the field or expression that the <code>$group</code> operator applies to the specific accumulator.</li></ul><p>Suppose we have a collection called <code>orders</code>, which contains documents representing sales data.</p><pre class="astro-code dracula" is:raw="" style=background-color:#282a36;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f8f8f2>[</span></span>
<span class=line><span style=color:#f8f8f2>  { _id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>1</span><span style=color:#f8f8f2>, customer_id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>C1</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, amount</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>110</span><span style=color:#f8f8f2> },</span></span>
<span class=line><span style=color:#f8f8f2>  { _id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>2</span><span style=color:#f8f8f2>, customer_id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>C2</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, amount</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>150</span><span style=color:#f8f8f2> },</span></span>
<span class=line><span style=color:#f8f8f2>  { _id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>3</span><span style=color:#f8f8f2>, customer_id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>C1</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, amount</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>90</span><span style=color:#f8f8f2> },</span></span>
<span class=line><span style=color:#f8f8f2>  { _id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>4</span><span style=color:#f8f8f2>, customer_id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>C3</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, amount</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>200</span><span style=color:#f8f8f2> },</span></span>
<span class=line><span style=color:#f8f8f2>  { _id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>5</span><span style=color:#f8f8f2>, customer_id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>C2</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, amount</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>50</span><span style=color:#f8f8f2> },</span></span>
<span class=line><span style=color:#f8f8f2>];</span></span></code></pre><p>Now, let’s group the data by <code>customer_id</code> and calculate each customer’s total spent amount.</p><pre class="astro-code dracula" is:raw="" style=background-color:#282a36;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f8f8f2>db.orders.</span><span style=color:#50fa7b>aggregate</span><span style=color:#f8f8f2>([</span></span>
<span class=line><span style=color:#f8f8f2>  {</span></span>
<span class=line><span style=color:#f8f8f2>    $group</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> {</span></span>
<span class=line><span style=color:#f8f8f2>      _id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>$customer_id</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>      total_spent</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> { $sum</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>$amount</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2> },</span></span>
<span class=line><span style=color:#f8f8f2>    },</span></span>
<span class=line><span style=color:#f8f8f2>  },</span></span>
<span class=line><span style=color:#f8f8f2>]);</span></span></code></pre><p>This query would result in the following:</p><pre class="astro-code dracula" is:raw="" style=background-color:#282a36;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f8f8f2>[</span></span>
<span class=line><span style=color:#f8f8f2>  { _id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>C1</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, total_spent</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>200</span><span style=color:#f8f8f2> },</span></span>
<span class=line><span style=color:#f8f8f2>  { _id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>C2</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, total_spent</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>200</span><span style=color:#f8f8f2> },</span></span>
<span class=line><span style=color:#f8f8f2>  { _id</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>C3</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, total_spent</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>200</span><span style=color:#f8f8f2> },</span></span>
<span class=line><span style=color:#f8f8f2>];</span></span></code></pre><p>Using the <code>$group</code> operator, documents in the <code>orders</code> collection were grouped by <code>customer_id</code>, and the total spent amount for each customer was calculated using the <code>$sum</code> accumulator.</p></main>